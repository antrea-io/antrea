---
apiVersion: apiextensions.k8s.io/v1beta1
kind: CustomResourceDefinition
metadata:
  name: antreacontrollerinfos.clusterinformation.antrea.tanzu.vmware.com
spec:
  group: clusterinformation.antrea.tanzu.vmware.com
  versions:
    - name: v1beta1
      served: true
      storage: true
  scope: Cluster
  names:
    plural: antreacontrollerinfos
    singular: antreacontrollerinfo
    kind: AntreaControllerInfo
    shortNames:
      - aci
---
apiVersion: apiextensions.k8s.io/v1beta1
kind: CustomResourceDefinition
metadata:
  name: antreaagentinfos.clusterinformation.antrea.tanzu.vmware.com
spec:
  group: clusterinformation.antrea.tanzu.vmware.com
  versions:
    - name: v1beta1
      served: true
      storage: true
  scope: Cluster
  names:
    plural: antreaagentinfos
    singular: antreaagentinfo
    kind: AntreaAgentInfo
    shortNames:
      - aai
---
apiVersion: apiextensions.k8s.io/v1beta1
kind: CustomResourceDefinition
metadata:
  name: clusternetworkpolicies.crd.antrea.tanzu.vmware.com
spec:
  group: crd.antrea.tanzu.vmware.com
  versions:
    - name: v1beta1
      served: true
      storage: true
  scope: Cluster
  names:
    plural: clusternetworkpolicies
    singular: clusternetworkpolicy
    kind: ClusterNetworkPolicy
    shortNames:
      - cnp
  # Prune any unknown fields
  preserveUnknownFields: false
  validation:
    openAPIV3Schema:
      type: object
      properties:
        spec:
          # Ensure that Spec.AppliedTo and Spec.Priority fields are set
          required:
            - appliedTo
            - priority
          type: object
          properties:
           priority:
             type: integer
             # Ensure that Spec.Priority field is between 1 and 32768
             minimum: 1
             maximum: 32768
           appliedTo:
             type: array
             items:
               type: object
               # Ensure that Spec.AppliedTo does not allow IPBlock field
               properties:
                 podSelector:
                   type: object
                   additionalProperties:
                     type: object
                 namespaceSelector:
                   type: object
                   additionalProperties:
                     type: object
           ingress:
             type: array
             items:
               type: object
               properties:
                 # Ensure that Action field allows only ALLOW and DROP values
                 action:
                   type: string
                   pattern: '\bALLOW|\bAllow|\ballow|\bDROP|\bDrop|\bdrop'
                 ports:
                   type: array
                   items:
                     type: object
                     properties:
                       protocol:
                         type: string
                       port:
                         x-kubernetes-int-or-string: true
                 from:
                   type: array
                   items:
                     type: object
                     properties:
                       podSelector:
                         x-kubernetes-preserve-unknown-fields: true
                       namespaceSelector:
                         x-kubernetes-preserve-unknown-fields: true
                       ipBlock:
                         type: object
                         properties:
                           cidr:
                             type: string
           egress:
             type: array
             items:
               type: object
               properties:
                 # Ensure that Action field allows only ALLOW and DROP values
                 action:
                   type: string
                   pattern: '\bALLOW|\bAllow|\ballow|\bDROP|\bDrop|\bdrop'
                 ports:
                   type: array
                   items:
                     type: object
                     properties:
                       protocol:
                         type: string
                       port:
                         x-kubernetes-int-or-string: true
                 to:
                   type: array
                   items:
                     type: object
                     properties:
                       podSelector:
                         x-kubernetes-preserve-unknown-fields: true
                       namespaceSelector:
                         x-kubernetes-preserve-unknown-fields: true
                       ipBlock:
                         type: object
                         properties:
                           cidr:
                             type: string
